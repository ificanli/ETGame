# M0 执行计划（3个月）

## 版本目标

MVP版本，验证 PVP战斗体验 和 基础的搜打撤体验。

## 核心原则

先跑通流程框架，再打磨战斗细节。战斗体验用现有点击移动+技能系统占位，不阻塞流程验证。

## 前置条件

- 已有能力：登录、进图、地图分配（MapManager）、AOI、寻路、技能/Buff、伤害/死亡事件
- 已有方案：9.3摇杆移动、9.4搜打撤流程改造、9.5自动普攻
- 缺失方案：关卡组件框架(ECA)、局内成长机制

## 依赖关系

```
匹配系统 ──→ 战局状态机 ──→ 死亡/撤离分支 ──→ 结算框架
     │                            ↑
     └── 多人同局(PVP) ───────────┘

ECA交互框架 ──→ 搜索容器 + 撤离点
                      ↑
局外装备携带 ──→ 局内背包 ──→ 结算写回

摇杆移动 ──→ 自动攻击 ──→ 武器切换/技能 ──→ 战斗手感
（以上可独立于流程，最后做）
```

## 里程碑总览

| 里程碑 | 时间 | 目标 | 优先级 |
|--------|------|------|--------|
| M0.1 | 第1-4周 | **框架搭建**：匹配系统、战局状态机、结算框架、ECA交互框架 | P0 |
| M0.2 | 第5-8周 | **流程验证**：装备携带、搜索容器、撤离点、局内成长、多人PVP | P0 |
| M0.3 | 第9-12周 | **体验打磨**：摇杆移动、自动攻击、武器切换、技能改造（战斗3C） | P1 |

**说明**：
- M0.1-M0.2 使用现有点击移动+技能系统占位，不阻塞流程验证
- M0.3 在框架和流程稳定后，专注战斗手感打磨

---

## M0.1 框架搭建（第1-4周）P0

### 目标
建立核心系统框架，跑通完整流程管线。

### 任务列表

#### 1. 匹配系统
- [ ] 匹配队列管理
- [ ] 多模式支持（PVE、1v1、3v3、搜打撤）
- [ ] 匹配成功后分配地图

#### 2. 战局状态机
- [ ] 战局生命周期管理（准备→战斗→结算）
- [ ] 死亡判定和处理
- [ ] 撤离判定和处理
- [ ] 战局结束条件

#### 3. 结算框架
- [ ] 结算数据收集
- [ ] 结算界面显示
- [ ] 返回大厅流程

#### 4. ECA交互框架（关卡组件框架）
- [ ] Event-Condition-Action 架构设计
- [ ] 交互物基础组件
- [ ] 状态管理系统

#### 5. 多人PVP基础
- [ ] 多人同局支持
- [ ] 玩家状态同步

**验收标准**：
- 能够匹配进入战局
- 使用现有点击移动+技能系统进行战斗
- 死亡或撤离后能正常结算并返回大厅

---

## M0.2 流程验证（第5-8周）P0

### 目标
填充搜打撤核心内容，验证完整游戏循环。

### 任务列表

#### 1. 局外装备携带
- [ ] 装备选择界面
- [ ] 枪械携带系统
- [ ] 英雄选择系统
- [ ] 装备数据传入战局

#### 2. 搜索容器（基于ECA框架）
- [ ] 容器交互组件
- [ ] 拾取物品逻辑
- [ ] 背包系统

#### 3. 撤离点（基于ECA框架）
- [ ] 撤离点交互组件
- [ ] 撤离条件判定
- [ ] 撤离成功流程

#### 4. 局内成长机制
- [ ] 击杀小怪获得经验
- [ ] 等级提升系统
- [ ] 肉鸽牌获取（待设计）

#### 5. 结算写回
- [ ] 财富计算
- [ ] 装备带出
- [ ] 数据持久化

**验收标准**：
- 能够携带装备进入战局
- 能够搜索容器获得物品
- 能够击杀小怪获得成长
- 能够通过撤离点带出财富
- 完整的搜打撤循环可玩

---

## M0.3 体验打磨（第9-12周）P1

### 目标
替换占位系统，打磨战斗3C手感。

### 任务列表

#### 1. 摇杆移动（参考9.3方案）
- [ ] 虚拟摇杆实现
- [ ] 移动手感调优
- [ ] 移动动画衔接

#### 2. 自动攻击（参考9.5方案）
- [ ] 自动索敌逻辑
- [ ] 攻击范围判定
- [ ] 攻击动画和特效

#### 3. 武器切换
- [ ] 武器格子UI
- [ ] 点击切换武器
- [ ] 不同武器参数（射程、伤害、攻速）
- [ ] 冲锋枪/步枪差异（移动攻击/停止攻击）

#### 4. 技能改造
- [ ] 滑动释放指向技能
- [ ] 双击释放大招
- [ ] 技能手感优化

**验收标准**：
- 摇杆移动流畅自然
- 自动攻击体验良好
- 武器切换响应及时
- 技能释放手感舒适
- 整体战斗体验达到可玩标准

---

## 风险控制

### 关键风险
1. **ECA框架设计复杂度**：可能影响M0.1进度
   - 缓解：先实现最小可用版本，后续迭代优化

2. **多人PVP同步问题**：可能出现延迟和不同步
   - 缓解：利用现有AOI和状态同步能力，先跑通再优化

3. **战斗3C手感调优耗时**：可能超出M0.3时间预算
   - 缓解：M0.3可延期或降低标准，不影响M0.1-M0.2核心验证

### 优先级原则
- **P0任务**：必须完成，阻塞后续验证
- **P1任务**：体验优化，可根据时间调整
- **战斗3C在最后**：确保框架和流程稳定后再打磨

